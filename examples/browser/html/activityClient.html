<!DOCTYPE html>
<html>
  <head>
    <script src="/muzzley-client-0.3.0.js"></script>
 </head>
<body>
  <h3>Muzzley JavaScript SDK Demo</h3>
  <img id="qrCodeImg"/>
  <script>
    //disable errors to the
    muzzley.sendErrors = true;

    muzzley.on('error', function(err){
      console.log(err);
    });

    muzzley.connectApp('muzzlionaire', function(err, activity){

      if (err) return console.log("err: " + err );

      var qrCodeImg = document.getElementById('qrCodeImg');
      qrCodeImg.src = activity.qrCodeUrl;

      console.log('##Activity: activityCreated');

      muzzley.connectUser('muzdev', activity.activityId, function(err, paticipant){
        if (err) return console.log("err: " + err );
        //console.log(paticipant);
        console.log('##User joinedActivity');
        paticipant.on('changeWidget', function(widget){
          console.log('##User changeWidget recived');
        });

      });

      console.log(activity);
      activity.on('participantQuit', function(participant){
        console.log('##Activity: "EVENT" participantQuit');
      });

      activity.on('participantJoin', function(participant){

        console.log('##Activity: participantJoined');
        console.log('##Activity: sending changeWidget');

        participant.changeWidget('gamepad', function (err) {
          if (err) return console.log("err: " + err );
          console.log('##Activity: recived changeWidget okay');

          participant.on('quit', function (action) {
            // Action object represents the participants interaction
            console.log('quit');
            //console.log(action);
          });


          participant.on('action', function (action) {
            // Action object represents the participants interaction
            console.log(action);
          });
        });
      });
    });
  </script>
</body>
</html>